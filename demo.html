<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ballancemaps-fetch</title>
  <style>
    #maps p {text-decoration: underline dotted; cursor: pointer}
  </style>
</head>
<body>
  <div id="maps"></div>
  <script src="ballancemaps-fetch.js"></script>
  <script>
    getGroupIndexes()
    .then((indexes) => {
      let div = "";
      indexes.forEach(index => {
        div += `<p onclick="showMapList('${index.id}', this.nextElementSibling)">${index.name}</p><table></table>`;
      });
      document.getElementById("maps").innerHTML = div;
    });

    async function showMapList(index, element) {
      const maps = await getMapList(index);
      let mapString = "<tr><th>Name</th><th>Size</th><th>Author</th><th>Difficulty</th><th>Notes</th><th>Upload time</th></tr>"
      maps.forEach(map => {
        mapString += `<tr><td><a href="${map[1]}">${map[2]}</a></td><td>${map[3]}</td><td>${map[4]}</td><td>${map[5]}</td><td>${(map[6] == undefined) ? '' : map[6]}</td><td>${map[7]}</td></tr>`;
      });
      element.innerHTML = mapString;
    };
  </script>
</body>
</html>